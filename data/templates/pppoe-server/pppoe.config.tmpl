
### generated by accel_pppoe.py ###
[modules]
log_syslog
pppoe
{% if authentication['mode'] == 'radius' %}
radius
{% endif %}
ippool
{% if ppp_options['ipv6'] != 'deny' %}
ipv6pool
ipv6_nd
ipv6_dhcp
{% endif %}
chap-secrets
auth_pap
auth_chap_md5
auth_mschap_v1
auth_mschap_v2
#pppd_compat
shaper
{% if snmp == 'enable' or snmp == 'enable-ma' %}
net-snmp
{% endif %}
{% if limits %}
connlimit
{% endif %}

[core]
thread-count={{thread_cnt}}

[log]
syslog=accel-pppoe,daemon
copy=1
level=5

{% if snmp == 'enable-ma' %}
[snmp]
master=1
{% endif -%}

[client-ip-range]
disable

{% if ppp_gw %}
[ip-pool]
gw-ip-address={{ppp_gw}}
{% if client_ip_pool %}
{{client_ip_pool}}
{% endif -%}

{% if client_ip_subnets %}
{% for sn in client_ip_subnets %}
{{sn}}
{% endfor %}
{% endif %}
{% endif -%}

{% if client_ipv6_pool %}
[ipv6-pool]
{% for prfx in client_ipv6_pool['prefix']: %}
{{prfx}}
{% endfor %}
{% for prfx in client_ipv6_pool['delegate-prefix']: %}
delegate={{prfx}}
{% endfor %}
{% endif %}

{% if dns %}
[dns]
{% if dns[0] %}
dns1={{dns[0]}}
{% endif -%}
{% if dns[1] %}
dns2={{dns[1]}}
{% endif -%}
{% endif %}

{% if dnsv6 %}
[ipv6-dns]
{% for srv in dnsv6: %}
{{srv}}
{% endfor %}
{% endif %}

{% if wins %}
[wins]
{% if wins[0] %}
wins1={{wins[0]}}
{% endif %}
{% if wins[1] %}
wins2={{wins[1]}}
{% endif -%}
{% endif -%}

{% if authentication['mode'] == 'local' %}
[chap-secrets]
chap-secrets=/etc/accel-ppp/pppoe/chap-secrets
{% endif -%}

{% if authentication['mode'] == 'radius' %}
[radius]
{% for rsrv in authentication['radiussrv']: %}
server={{rsrv}},{{authentication['radiussrv'][rsrv]['secret']}},\
req-limit={{authentication['radiussrv'][rsrv]['req-limit']}},\
fail-time={{authentication['radiussrv'][rsrv]['fail-time']}}
{% endfor %}
{% if authentication['radiusopt']['timeout'] %}
timeout={{authentication['radiusopt']['timeout']}}
{% endif %}
{% if authentication['radiusopt']['acct-timeout'] %}
acct-timeout={{authentication['radiusopt']['acct-timeout']}}
{% endif %}
{% if authentication['radiusopt']['max-try'] %}
max-try={{authentication['radiusopt']['max-try']}}
{% endif %}
{% if authentication['radiusopt']['nas-id'] %}
nas-identifier={{authentication['radiusopt']['nas-id']}}
{% endif %}
{% if authentication['radiusopt']['nas-ip'] %}
nas-ip-address={{authentication['radiusopt']['nas-ip']}}
{% endif -%}
{% if authentication['radiusopt']['dae-srv'] %}
dae-server={{authentication['radiusopt']['dae-srv']['ip-addr']}}:\
{{authentication['radiusopt']['dae-srv']['port']}},\
{{authentication['radiusopt']['dae-srv']['secret']}}
{% endif -%}
gw-ip-address={{ppp_gw}}
verbose=1

{% if authentication['radiusopt']['shaper'] %}
[shaper]
verbose=1
attr={{authentication['radiusopt']['shaper']['attr']}}
{% if authentication['radiusopt']['shaper']['vendor'] %}
vendor={{authentication['radiusopt']['shaper']['vendor']}}
{% endif -%}
{% endif -%}
{% endif %}

[ppp]
verbose=1
check-ip=1
{% if not sesscrtl == 'disable' %}
single-session={{sesscrtl}}
{% endif -%}
{% if ppp_options['ccp'] %}
ccp=1
{% endif %}
{% if ppp_options['min-mtu'] %}
min-mtu={{ppp_options['min-mtu']}}
{% else %}
min-mtu={{mtu}}
{% endif %}
{% if ppp_options['mru'] %}
mru={{ppp_options['mru']}}
{% endif %}
{% if ppp_options['mppe'] %}
mppe={{ppp_options['mppe']}}
{% else %}
mppe=prefer
{% endif %}
{% if ppp_options['lcp-echo-interval'] %}
lcp-echo-interval={{ppp_options['lcp-echo-interval']}}
{% else %}
lcp-echo-interval=30
{% endif %}
{% if ppp_options['lcp-echo-timeout'] %}
lcp-echo-timeout={{ppp_options['lcp-echo-timeout']}}
{% endif %}
{% if ppp_options['lcp-echo-failure'] %}
lcp-echo-failure={{ppp_options['lcp-echo-failure']}}
{% else %}
lcp-echo-failure=3
{% endif %}
{% if ppp_options['ipv4'] %}
ipv4={{ppp_options['ipv4']}}
{% endif %}
{% if client_ipv6_pool %}
ipv6=allow
{% endif %}

{% if ppp_options['ipv6'] %}
ipv6={{ppp_options['ipv6']}}
{% if ppp_options['ipv6-intf-id'] %}
ipv6-intf-id={{ppp_options['ipv6-intf-id']}}
{% endif %}
{% if ppp_options['ipv6-peer-intf-id'] %}
ipv6-peer-intf-id={{ppp_options['ipv6-peer-intf-id']}}
{% endif %}
{% if ppp_options['ipv6-accept-peer-intf-id'] %}
ipv6-accept-peer-intf-id={{ppp_options['ipv6-accept-peer-intf-id']}}
{% endif %}
{% endif %}
mtu={{mtu}}

[pppoe]
verbose=1
{% if concentrator %}
ac-name={{concentrator}}
{% endif %}
{% if interface %}
{% for int in interface %}
interface={{int}}
{% if interface[int]['vlans'] %}
vlan-mon={{int}},{{interface[int]['vlans']|join(',')}}
interface=re:{{int}}\.\d+
{% endif %}
{% endfor -%}
{% endif -%}

{% if svc_name %}
service-name={{svc_name|join(',')}}
{% endif -%}

{% if pado_delay %}
pado-delay={{pado_delay}}
{% endif %}

{% if limits %}
[connlimit]
limit={{limits['conn-limit']}}
burst={{limits['burst']}}
timeout={{limits['timeout']}}
{% endif %}

[cli]
tcp=127.0.0.1:2001
