<?xml version="1.0" encoding="utf-8"?>
<!-- Protocol RPKI configuration -->
<interfaceDefinition>
  <node name="protocols">
    <children>
      <node name="nrpki" owner="${vyos_conf_scripts_dir}/protocols_rpki.py">
        <properties>
          <help>BGP prefix origin validation</help>
        </properties>
        <children>
          <tagNode name="cache">
            <properties>
              <help>RPKI cache server instance</help>
            </properties>
            <children>
              <leafNode name="address">
                <properties>
                  <help>RPKI cache server address</help>
                </properties>
              </leafNode>
              <leafNode name="port">
                <properties>
                  <help>TCP port number</help>
                  <valueHelp>
                    <format>u32:1-65535</format>
                    <description>TCP port number</description>
                  </valueHelp>
                  <constraint>
                    <validator name="numeric" argument="--range 1-65535"/>
                  </constraint>
                </properties>
              </leafNode>
              <node name="ssh">
                <properties>
                  <help>RPKI SSH connection settings</help>
                </properties>
                <children>
                  <leafNode name="known-hosts-file">
                    <properties>
                      <help>RPKI SSH known hosts file</help>
                      <constraint>
                        <validator name="file-exists"/>
                      </constraint>
                    </properties>
                  </leafNode>
                  <leafNode name="private-key-file">
                    <properties>
                      <help>RPKI SSH private key file</help>
                      <constraint>
                        <validator name="file-exists"/>
                      </constraint>
                    </properties>
                  </leafNode>
                  <leafNode name="public-key-file">
                    <properties>
                      <help>RPKI SSH public key file path</help>
                      <constraint>
                        <validator name="file-exists"/>
                      </constraint>
                    </properties>
                  </leafNode>
                  <leafNode name="username">
                    <properties>
                      <help>RPKI SSH username</help>
                    </properties>
                  </leafNode>
                </children>
              </node>
            </children>
          </tagNode>
          <leafNode name="initial-synchronization-timeout">
            <properties>
              <help>Initial RPKI cache synchronization timeout</help>
              <valueHelp>
                <format>u32:0-4294967295</format>
                <description>Initial RPKI cache synchronization timeout</description>
              </valueHelp>
              <constraint>
                <validator name="numeric" argument="--range 0-4294967295"/>
              </constraint>
            </properties>
          </leafNode>
          <leafNode name="polling-period">
            <properties>
              <help>RPKI cache polling period</help>
              <valueHelp>
                <format>u32:1-1300</format>
                <description>Polling period</description>
              </valueHelp>
              <constraint>
                <validator name="numeric" argument="--range 1-1300"/>
              </constraint>
            </properties>
          </leafNode>
          <leafNode name="preference">
            <properties>
              <help>RPKI cache preference</help>
              <valueHelp>
                <format>u32:0-4294967295</format>
                <description>RPKI cache preference</description>
              </valueHelp>
              <constraint>
                <validator name="numeric" argument="--range 0-4294967295"/>
              </constraint>
            </properties>
          </leafNode>
          <leafNode name="timeout">
            <properties>
              <help>RPKI cache reply timeout</help>
              <valueHelp>
                <format>u32:0-4294967295</format>
                <description>RPKI cache reply timeout</description>
              </valueHelp>
              <constraint>
                <validator name="numeric" argument="--range 0-4294967295"/>
              </constraint>
            </properties>
          </leafNode>
        </children> 
      </node>
    </children>
  </node>
</interfaceDefinition>
